import"./DarkModeToggle.astro_astro_type_script_index_0_lang.LcnWjRTo.js";const l=document.querySelector("#chat"),g=document.querySelector("#chat-toggle");document.querySelector("#chat-window");const o=document.querySelector("#chat-window-history");document.querySelector("#chat-window-input");const p=document.querySelector("#chat-window-send"),i=document.querySelector("#chat-window-input input"),m=(e,n)=>{const t=document.createElement("li");return t.classList.add(`message-${e}`),t.innerText=n,t},T=()=>{const e=document.createElement("li");return e.classList.add("message-bot"),e.innerHTML=`
            <div class="loading">
                <div class="loading-dot"></div>
                <div class="loading-dot"></div>
                <div class="loading-dot"></div>
            </div>
        `,e},w=async()=>{const e=i.value;if(e){o.appendChild(m("user",e)),i.value="",i.setAttribute("disabled","true");const n=T();o.appendChild(n),await b(n),i.removeAttribute("disabled"),o.scrollTop=o.scrollHeight}},b=async e=>{const n=Array.from(o.querySelectorAll("li")).map(c=>({role:c.classList.contains("message-user")?"user":"assistant",content:c.innerText})),h=(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"system",content:"The following is a conversation with an AI assistant. The assistant is an expert cook with 15 years of experience and won multiple awards internationally. The assistant is helpful, creative, clever, and very friendly.The assistant will evaluate the question of the user and check if it is related to the scope of cooking, the assistant will not be able to answer to any other questions that is not related to cooking."},...n],max_tokens:300,temperature:.9,top_p:1,presence_penalty:.6,frequency_penalty:.6,stop:["[DONE]"],stream:!0})})).body?.getReader(),r=m("bot","");for(o.replaceChild(r,e);;){const{done:c,value:y}=await h?.read();if(c)break;const f=new TextDecoder("utf-8").decode(y).split(`
`).map(s=>s.replace(/data: /,"").trim()).filter(s=>s.length>0&&!s.includes("[DONE]")).map(s=>JSON.parse(s));for(const s of f){const{choices:A}=s,{delta:M}=A[0],{content:u}=M;u&&(r.innerText+=u)}}return r};g&&l&&g.addEventListener("click",()=>{l.getAttribute("data-active")==="true"?l.setAttribute("data-active","false"):l.setAttribute("data-active","true")});p&&i&&o&&(p.addEventListener("click",()=>{w()}),i.addEventListener("keyup",e=>{e.key==="Enter"&&w()}));let v="",d=!1,a;function x(){const e=document.getElementById("start-listening"),n=document.querySelector("#chat-window-input input");window.SpeechRecognition||window.webkitSpeechRecognition?(a=new(window.SpeechRecognition||window.webkitSpeechRecognition),a.onstart=()=>{d=!0,e.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#BC4949" viewBox="0 0 256 256">
            <path d="M213.92,210.62l-160-176A8,8,0,1,0,42.08,45.38L80,87.09V128a48,48,0,0,0,73.91,40.4l10.88,12A64,64,0,0,1,64,128a8,8,0,0,0-16,0,80.11,80.11,0,0,0,72,79.6V232a8,8,0,0,0,16,0V207.59a79.74,79.74,0,0,0,39.62-15.31l26.46,29.1a8,8,0,1,0,11.84-10.76ZM128,160a32,32,0,0,1-32-32V104.69l46.92,51.62A32,32,0,0,1,128,160ZM87.16,38.78A48,48,0,0,1,176,64v60.43a8,8,0,0,1-16,0V64a32,32,0,0,0-59.24-16.81,8,8,0,1,1-13.6-8.41ZM187.64,151.27A63.71,63.71,0,0,0,192,128a8,8,0,0,1,16,0,79.62,79.62,0,0,1-5.46,29.09,8,8,0,1,1-14.9-5.82Z">
            </path>
          </svg>`},a.onresult=t=>{const h=t.results.length-1;v=t.results[h][0].transcript,n.value=v},a.onend=()=>{d=!1,e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#000000" viewBox="0 0 256 256"><path d="M128,176a48.05,48.05,0,0,0,48-48V64a48,48,0,0,0-96,0v64A48.05,48.05,0,0,0,128,176ZM96,64a32,32,0,0,1,64,0v64a32,32,0,0,1-64,0Zm40,143.6V232a8,8,0,0,1-16,0V207.6A80.11,80.11,0,0,1,48,128a8,8,0,0,1,16,0,64,64,0,0,0,128,0,8,8,0,0,1,16,0A80.11,80.11,0,0,1,136,207.6Z"></path></svg> '},a.onerror=t=>{d=!1,e.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#d72b2b" viewBox="0 0 256 256">
            <path d="M213.92,210.62l-160-176A8,8,0,1,0,42.08,45.38L80,87.09V128a48,48,0,0,0,73.91,40.4l10.88,12A64,64,0,0,1,64,128a8,8,0,0,0-16,0,80.11,80.11,0,0,0,72,79.6V232a8,8,0,0,0,16,0V207.59a79.74,79.74,0,0,0,39.62-15.31l26.46,29.1a8,8,0,1,0,11.84-10.76ZM128,160a32,32,0,0,1-32-32V104.69l46.92,51.62A32,32,0,0,1,128,160ZM87.16,38.78A48,48,0,0,1,176,64v60.43a8,8,0,0,1-16,0V64a32,32,0,0,0-59.24-16.81,8,8,0,1,1-13.6-8.41ZM187.64,151.27A63.71,63.71,0,0,0,192,128a8,8,0,0,1,16,0,79.62,79.62,0,0,1-5.46,29.09,8,8,0,1,1-14.9-5.82Z">
            </path>
          </svg>`,console.error("Speech recognition error:",t.error)},a.start()):e.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="52" height="52" fill="#BC4949" viewBox="0 0 256 256">
            <path d="M213.92,210.62l-160-176A8,8,0,1,0,42.08,45.38L80,87.09V128a48,48,0,0,0,73.91,40.4l10.88,12A64,64,0,0,1,64,128a8,8,0,0,0-16,0,80.11,80.11,0,0,0,72,79.6V232a8,8,0,0,0,16,0V207.59a79.74,79.74,0,0,0,39.62-15.31l26.46,29.1a8,8,0,1,0,11.84-10.76ZM128,160a32,32,0,0,1-32-32V104.69l46.92,51.62A32,32,0,0,1,128,160ZM87.16,38.78A48,48,0,0,1,176,64v60.43a8,8,0,0,1-16,0V64a32,32,0,0,0-59.24-16.81,8,8,0,1,1-13.6-8.41ZM187.64,151.27A63.71,63.71,0,0,0,192,128a8,8,0,0,1,16,0,79.62,79.62,0,0,1-5.46,29.09,8,8,0,1,1-14.9-5.82Z">
            </path>
          </svg>`}document.getElementById("start-listening").addEventListener("click",()=>{d?a?.stop():x()});
