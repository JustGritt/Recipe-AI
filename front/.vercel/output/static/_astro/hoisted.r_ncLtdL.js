import"./DarkModeToggle.astro_astro_type_script_index_0_lang.LcnWjRTo.js";import"./hoisted.8y_q3anB.js";const u=document.getElementById("recoButton"),E=document.getElementById("copyButton"),b=document.getElementById("instructionSection"),g=document.getElementById("recoContainer"),v=async()=>{if(g.childElementCount>0){console.log("Quick exit"),g.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"});return}u.disabled=!0,u.classList.add("opacity-50","cursor-not-allowed");const o=Array.from(b.querySelectorAll("li")).map(c=>({role:"user",content:c.innerText})),a=(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"system",content:"You are now to act as an expert chef with 10 years of experience. Your goal is to help me pair my current recipe with a selection of wine, cheese or dessert that would fit the best. Suggest a low calorie and vegan alternative if and recommend seasonal products if possible."},...o],max_tokens:1e3,temperature:.9,top_p:1,presence_penalty:.6,frequency_penalty:.6,stop:["[DONE]"],stream:!0})})).body?.getReader(),s=document.createElement("div");for(s.classList.add("flex","gap-4","my-4");;){const{done:c,value:p}=await a?.read();if(c)break;const i=new TextDecoder("utf-8").decode(p).split(`
`).map(e=>e.replace(/data: /,"").trim()).filter(e=>e.length>0&&!e.includes("[DONE]")).map(e=>JSON.parse(e));for(const e of i){const{choices:m}=e,{delta:l}=m[0],{content:n}=l;n&&(s.innerText+=n,g.appendChild(s))}}return u.disabled=!1,u.classList.remove("opacity-50","cursor-not-allowed"),s};u?.addEventListener("click",()=>{v()});E?.addEventListener("click",()=>{const o=()=>Array.from(b.querySelectorAll("li")).map(t=>t.innerText);navigator.clipboard.writeText(o().join(`
`))});const k=o=>{const t=document.createElement("form");t.classList.add("flex","flex-col","items-center","justify-center","w-full"),f.appendChild(t);const a=document.createElement("div");a.classList.add("w-full","flex","flex-row","justify-start","items-center","gap-2","mr-0","ml-0","my-2");const s=document.createElement("h3");s.textContent=`Comment as ${o}`,s.classList.add("text-black","text-2xl","font-bold","mb-4","w-full","text-left","mb-0"),a.appendChild(s);const c=document.createElement("label");c.textContent="Rating:",c.classList.add("text-black","text-xl","font-bold","mr-2"),a.appendChild(c);let p="";for(let l=0;l<5;l++){const n=document.createElement("input");n.setAttribute("type","radio"),n.setAttribute("name","rating"),n.setAttribute("value",`${l+1}`),n.addEventListener("click",()=>{parseInt(n.value),p=n.value}),a.appendChild(n)}t.appendChild(a);const r=document.createElement("textarea");r.classList.add("w-full","min-h-[6rem]","bg-gray-100","text-black","rounded-md","p-4","mx-2","mt-2","outline-none","text-black","border-2","border-gray-300","transition","duration-200","ease-in-out"),r.setAttribute("placeholder","Write a comment...");const d=document.createElement("div");d.classList.add("w-full","flex","flex-row","justify-end","items-end","gap-2","ml-auto","mr-0","mt-4","w-80");const i=document.createElement("button");i.textContent="Post",i.classList.add("w-1/2","inline","bg-gray-400","text-black","rounded-lg","p-2","mb-2"),i.setAttribute("type","submit");const e=document.createElement("button");e.textContent="Cancel",e.classList.add("w-1/2","inline","bg-gray-400","text-black","rounded-lg","p-2","mb-2"),e.setAttribute("type","button"),t.appendChild(r),t.appendChild(d),d.appendChild(i),d.appendChild(e),t.addEventListener("submit",async l=>{l.preventDefault();const n=r.value,x=localStorage.getItem("jwt")||null,w=p,C=window.location.pathname.split("/")[2];await(await fetch("http://localhost:3000/api/ratings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:n,token:x,rating:w,recipeId:C})})).json().then(A=>window.location.reload())}),e.addEventListener("click",()=>{r.value=""});const m=document.createElement("ul");m.classList.add("w-full","bg-slate-600","rounded-lg","p-4","mt-4"),f.appendChild(m),m.style.display="none"},h=()=>{const o=document.createElement("p");o.textContent="You need to be logged in to comment",o.classList.add("py-4","text-center","text-black","text-xl","m-0"),f.appendChild(o)},y=localStorage.getItem("jwt")||null;document.getElementById("side-links");const f=document.getElementById("comments");y?await(await fetch("http://localhost:3000/api/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:y})})).json().then(t=>{if(t.status==="success"){const a=t.user.username;k(a)}else h()}):h();
